Rosario Student Information System - INSTALLATION DIRECTIONS

-------------------------------------------------------------------------------
Version 2.7-beta
-------------------------------------------------------------------------------

NOTE: Before Installing RosarioSIS, you must read and agree to the included
license.

RosarioSIS is a web based application which relies on other facilities such as
a web server, PHP server-side scripting, and postgres database server.  For
RosarioSIS to work you must first have your web server working, PHP working,
postgres working. username/password authentication working.  Setting these
up varies a lot with platform, operating system, and distribution so it is
well beyond to scope of this brief install document. RosarioSIS 1.0 was
tested on a Windows 7 x64 with Apache 2.2.21, Postgres 9.1, and PHP 5.3.9 
(EasyPHP 5.3.9) and on a Ubuntu Server 12.04 with Apache 2.2.22, Postgres 9.1, 
and PHP 5.3.10 and through Mozilla Firefox.

Minimum requirements: PHP 5.3.2 & Postgres 8

Installation Instructions for Windows:
https://github.com/francoisjacquet/rosariosis/wiki/How-to-install-RosarioSIS-on-Windows

Installing the Package
----------------------

Unzip the RosarioSIS distribution to a directory that is accessible to your web
browser. Edit the config.inc.sample.php file to set the configuration variables 
as appropriate for your installation. Rename the file to config.inc.php.

  $DatabaseServer is the host name or ip for the database server
  $DatabaseUsername is the username used for authenticating the database
  $DatabasePassword is the password used for authenticating the database
  $DatabaseName is the database name
  $DatabasePort is the socket port number for accessing the database server

  $RosarioPath is full path to RosarioSIS installation, you can define it 
	statically for your installation or the runtime value derived from the 
	__FILE__ magic constant should work
  $pg_dumpPath is full path to the postgres database dump utility pg_dump
  $wkhtmltopdfPath full path to wkhtmltopdf for pdf 'printing'
  $wkhtmltopdfAssetsPath is path where wkhtmltopdf will access the assets/
    directory, possibly different than how the user's web browser finds it,
    empty string means no translation
  $StudentPicturesPath relative path to student pictures
  $UserPicturesPath relative path to user pictures
  $PortalNotesFilesPath relative path to portal notes attached files
  $FS_IconsPath relative path to food service icons
  
  $DefaultSyear default school year, should be present in the database to 
    be able to login
  $RosarioNotifyAddress is email address to send error and new administrator notifications
  $RosarioLocales is a comma separated list of the locale names of the 
    translations


Now, you're ready to setup the RosarioSIS database. If you have access to the
command prompt for your server, follow these instructions.  If you're using
phpPGAdmin or a similar tool, import the rosariosis.sql file included in
this package.

	1) Open a command prompt window.
	2) Login as the postgres user
		ex) server$ su - postgres
	3) Login to the postgres database server using the template1 database
		ex) server$ psql template1
	4) Create the rosariosis database
		ex) template1=# CREATE DATABASE rosariosis;
	5) Skip to step 6 if used in an American / English-speaking environment.
			If your data will include non-standard English characters (like
			characters with accent marks), you'll have to create your database
			with a different character encoding (the default is unicode).
			ex) createdb rosariosis -E UTF8
			UTF8 is Unicode, 8-bit -- useful for all languages.
			See http://www.postgresql.org/docs/9.1/interactive/multibyte.html for
			more information.
	6) Logout of the database server
		ex) template1=# \q
	7) Run the RosarioSIS sql file
		ex) server$ psql rosariosis < YOUR_ROSARIO_INSTALL_DIRECTORY/rosariosis.sql > rosariosis.log

Notice, you will see several lines beginning "NOTICE:  ALTER TABLE / ADD PRIMARY
KEY will create implicit index " after completing direction 6.  Disregard these
messages.

If you run into permissions problems involving rosariosis.log, simply remove the 
" > rosariosis.log" from the command

You will have to start postmaster with the -i option, telling postmaster to accept
TCP/IP connections.  Also, the pg_hba.conf file may have to be altered to specify the
server's TCP/IP address.

That's it!... now, point your browser to:

	http://yourdomain.com/INSTALL_LOCATION/index.php

and login as 'admin' password 'admin'.  With this login, you can create new
users, and change and delete the three template users.  Since students can not
be deleted the template student should be changed to a proper student and the
template photo deleted.


Installing wkhtmltopdf
----------------------

http://wkhtmltopdf.org/
Install instructions for Ubuntu 12.04.4 64bits server:

	1) Install the dependencies :
	server$ sudo apt-get install openssl build-essential xorg libssl-dev libxrender-dev
	
	1) Download the latest executable (0.12.1 as of 2014.08.14) :
	server$ wget http://downloads.sourceforge.net/project/wkhtmltopdf/0.12.1/wkhtmltox-0.12.1_linux-precise-amd64.deb

	2) Install package :
	server$ sudo dpkg --install wkhtmltox-0.12.1_linux-precise-amd64.deb
	
	3) Test :
	server$ wkhtmltopdf http://google.com google.pdf
	
	4) Set $wkhtmltopdfPath in RosarioSIS config.inc.php file:
	$wkhtmltopdfPath = '/usr/local/bin/wkhtmltopdf';

WKHTMLTOPDF and other tips for Linux Users on a Shared hosting system.
Based on various contributions on many resources online which are scattered around and my experience the following steps may assist you.

You will likely have some restrictions on a shared hosting server.
When you upload to your root, do not copy the files from the www folder only, copy all files to root and then navigate to the path of root/yourpathtosite/www/install
follow the prompts and you will be happy. Login with the login admin and admin and first change password and in case something goes bad. make sure not to delete the install folder but rename it on your host server.
use phpmyadmin for your pgsql and upload the sql dump that is in your root folder manually.

Based on various contributions and my experience the following steps may assist you.
1. request ssh access from your host
2. Ask your host which of the files are relevant for your hosting environment on the list here http://wkhtmltopdf.org/downloads.html
3. You now have two options.  Depending on the space on your server and for ease, either

a) download the relevant file which will be in .rpm you must then use the unzip facility such as 7zip to unzip it to get to the data.tar file which you need 
then upload the data.tar file to your root folder or to a location you can access eg another server or another file repository and save the path to this file somewhere safe
use ssh command prompt to unzip it down. I found easier unzip the rpm, upload data.tar to my host and proceed with step one.
b) You can use the file path from the repository i.e right click and copy and past the file url somewhere safe. then unzip the rpm using command prompt. 
I did not do this. But the command if you decide to is ar p mypackage.deb data.tar.gz | tar zx
More info here http://www.g-loaded.eu/2008/01/28/how-to-extract-rpm-or-deb-packages/
(This method did not work for me, because my ssh was rejecting the repository url. and the rpm file was not accepting the command even when saved on my root folder)
For this reason, from this point, I do not mention the steps for this method anymore but if you use it then you must go to step 4 AND YOU WILL BE FINISHED WITH THE SETUP.

OTHERWISE IF YOU USED OPTION (a) Then
If you use either option make sure you keep the file path  you need it next

4. Download and Install an ssh command tool like BitVise and put your credentials from step 1
5. Use command prompt to get this going as follows
COMMAND PROMPT STEPS:

STEP1 CHECK EVERTHING IS OKAY
YOUR HOST:~$ wget --spider http://PATHTOFILE/data.tar [PRESS ENTER KEY] THEN THE BELOW SOMETHING SIMILAR SHOULD HAPPEN
Spider mode enabled. Check if remote file exists.
--2000-01-06 04:50:05-- http://PATHTOFILE/data.tar
Resolving http://PATHTOFILE/data.tar... 00.000.000.00
Connecting to http://PATHTOFILE/data.tar|00.000.000.00|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 121815040 (116M) [application/x-tar]
Remote file exists.
STEP 2
YOUR HOST:~$ wget http://PATHTOFILE/data.tar[PRESS ENTER KEY] THEN THE BELOW SOMETHING SIMILAR SHOULD HAPPEN
--2000-01-06 04:50:48-- http://PATHTOFILE/data.tar
Resolving PATHTOFILEg... 00.000.000.00
Connecting to PATHTOFILE|00.000.000.00|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 121815040 (116M) [application/x-tar]
Saving to: `data.tar'

100%[======================================>] 121,815,040 47.4M/s in 2.5s

2000-01-06 04:50:52 (47.4 MB/s) - `data.tar' saved [121815040/121815040]

STEP 3
YOUR HOST:~$ tar -xvf data.tar [PRESS ENTER KEY] THEN THE BELOW SOMETHING SIMILAR SHOULD HAPPEN:
./
./usr/
./usr/local/
./usr/local/lib/
./usr/local/lib/libwkhtmltox.so
./usr/local/lib/libwkhtmltox.so.0.12
./usr/local/lib/libwkhtmltox.so.0
./usr/local/lib/libwkhtmltox.so.0.12.1
./usr/local/bin/
./usr/local/bin/wkhtmltoimage
./usr/local/bin/wkhtmltopdf
./usr/local/include/
./usr/local/include/wkhtmltox/
./usr/local/include/wkhtmltox/image.h
./usr/local/include/wkhtmltox/dllbegin.inc
./usr/local/include/wkhtmltox/pdf.h
./usr/local/include/wkhtmltox/dllend.inc
./usr/local/share/
./usr/local/share/man/
./usr/local/share/man/man1/
./usr/local/share/man/man1/wkhtmltoimage.1.gz
./usr/local/share/man/man1/wkhtmltopdf.1.gz

STEP 4
FINAL STEP IS TO DO PUT THE PATH IN YOUR CONFIG FILE WHICH IS IN YOUR ROOT FOR WEBSITE/config.inc.php

Look for this line 

$wkhtmltopdfPath = '/usr/bin/wkhtmltopdf'; // empty string means wkhtmltopdf will not be called and reports will be rendered in html instead of pdf
and change it to the path shown above when you did your install which for the above is /usr/local/bin/wkhtmltoimage

Activate PHP mail() function
----------------------------

Install instructions for Ubuntu 12.04.4 64bits server:
	server$ sudo apt-get install sendmail


Additional Configuration
------------------------

RosarioSIS comes with an empty calendar, so the first thing you should do is create a calendar or recreate the Main calendar with school days (in green).

See the School Configuration program in the School Setup module for optional modules configuration.
